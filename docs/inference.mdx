---
title: "Inference"
---


## Modeling Azure ND A100 v4-series GPU

From [Andrew A. Chien, Liuzixuan Lin, Hai Nguyen, Varsha Rao, Tristan Sharma, and Rajini Wijayawardana. 2023. Reducing the Carbon Impact of Generative AI Inference (today and in 2035). In 2nd Workshop on Sustainable Computer Systems (HotCarbon â€™23), July 9, 2023, Boston, MA, USA. ACM, New York, NY, USA, 7 pages.](https://dl.acm.org/doi/pdf/10.1145/3604930.3605705):

ğ‘‡ğ·ğ‘ƒ = 0.428 kW per GPU (1/8 of 3.43 kW for the instance) x 1.1 PUE

ğ‘‚ğ¼ = 0.35 is TFLOPS per inference assuming GPT-3 model (around 175 billion weights) processed with BF16 operations. 

ğ¼ğ‘Š = 5 is the number of inferences per output word (assumed window/sampling of 5 for each output word)

ğ‘Šğ¶ is the output word count (measured average of 185 output words/request)

ğ¶ = 156 TFLOPS is the GPU capacity assuming 50% efficiency

ğ¸hğ‘¤ is per-GPU emission calculated as 1/8 of estimated per-instance emissions:
ğ¸hğ‘¤ = 1/8 (ğ‘ƒğ¹ +ğ¸ğºğ‘ƒğ‘ˆ +ğ¸ğ¶ğ‘ƒğ‘ˆ +ğ¸ğ·ğ‘…ğ´ğ‘€ +ğ¸ğ‘†ğ‘†ğ· +ğ¸ğ»ğ·ğ·)
where ğ‘ƒğ¹ is IC packaging Carbon footprint while ğ¸ğºğ‘ƒğ‘ˆ , ğ¸ğ¶ğ‘ƒğ‘ˆ , ğ¸ğ·ğ‘…ğ´ğ‘€, ğ¸ğ‘†ğ‘†ğ·, and ğ¸ğ»ğ·ğ· are GPU, CPU, memory, and storage emissions, respectively. We estimate these emissions based on previous reports [26] and instance hardware specifications [1, 3, 11], yielding ğ¸hğ‘¤ = 318 kgCO2 per GPU

### Water Use
Water consumption per wafer-layer (Liter/12-inch equivalent wafer mask layer) from [TSMC 2022 ESG report](https://esg.tsmc.com/en-US/file/public/e-all_2022.pdf)

With the help of Claude 3.5 Sonnet:

1. Given information:
   - Water consumption: 137.3 L per 12-inch equivalent wafer mask layer
   - A100 (GA100) die size: 826 mmÂ² or 8.26 cmÂ²

2. Area of a 12-inch wafer:
   - 12 inches = 30.48 cm
   - Area of 12" wafer = Ï€ * (30.48/2)Â² â‰ˆ 729.66 cmÂ²

3. Estimated A100 chips per wafer:
   - 729.66 cmÂ² / 8.26 cmÂ² â‰ˆ 88.34 chips
   - Accounting for edge wastage, let's estimate 70 chips per wafer

4. Water use per chip per layer:
   - 137.3 L / 70 chips â‰ˆ 1.96 L per chip per layer

5. Estimated number of layers:
   - For a 7nm process chip like the A100, let's assume 75 layers

6. Estimated total water use per A100 chip:
   - 1.96 L * 75 layers â‰ˆ 147 L per A100 chip

Based on this calculation, each A100 chip might require approximately 147 liters of water in its manufacturing process.

Caveats:
- This is an estimate based on average water use per wafer layer.
- It doesn't account for potential water recycling or specific process variations.
- The actual number of layers may differ.
- Additional water use in other manufacturing steps is not included.

For a more precise figure, you'd need detailed information from NVIDIA or their manufacturing partners about the specific processes used for the A100.
