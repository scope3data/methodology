---
title: "Server cluster"
description: "Methodology for calculating the water, energy, and embodied emissions of a server cluster based on time"
---

## Overview

A server cluster is a group of servers in a single datacenter or cloud platform. Calculating the aggregate emissions of the cluster creates a logical entity that can be used to model how software uses this cluster. A key note is that a cluster is assumed to have uniform utilization. A higher-level abstraction is necessary to model the relationships between different components of a computing system.

## Inputs: Defining a cluster

A cluster is defined by:
- GPU manufacturer, model, and specs (see [gpu specs](https://github.com/mlco2/impact/blob/master/data/gpus.csv))
- Server manufacturer, model, and specs - if hosted in a cloud, what instance type
- Number of GPUs in the cluster
- Number of servers/instances in the cluster (if static)
- Cloud region or datacenter details (see below)

### Datacenter details
A datacenter is defined by:
- PUE
- WUE
- Grid region
- On-site or dedicated renewable energy by hour
- Overhead equipment (racks, networking gear, etc) embodied emissions per server-hour (usage is included in PUE) - cool [tour of a Meta datacenter](https://metainfrahardware.com/#/web/1)

### Example

| Component | Disclosed data |
| --------- | -------------- |
| GPU | Nvidia A100 80GB |
| Server | HPE Apollo 6500 Gen10 Plus |
| Number of GPUs | 384 |
| Number of servers | 48 |

## Outputs: Calculating cluster impact

The cluster methodology produces the following outputs:
- Embodied emissions per hour reserved
- Manufacturing water consumption per hour reserved
- Usage energy coefficients per below equation:
  - idle cluster power
  - net CPU TDP (CPU max power - CPU idle power)
  - net GPU TDP (GPU max power - GPU idle power)
  - number of CPUs
  - number of GPUs
- Peak throughput-Î± (as described by [OpenCarbonEval](https://arxiv.org/pdf/2405.12843))
- Peak TFLOPs/s

### Energy use

The energy calculation uses derived data from the cluster definition:
- The TDP of the GPU (provided by the manufacturer)
- The TDP of the CPU (provided by the manufacturer)
- The idle power draw of the server (see [Cloud Carbon Footprint](https://www.cloudcarbonfootprint.org) for common cloud instances). This power draw should include DRAM, NIC, SSD, and other components in the server. Boavizta has [some tools](https://www.google.com/url?q=https://doc.api.boavizta.org/Explanations/devices/server/&sa=D&source=docs&ust=1724184341034574&usg=AOvVaw10-gZiQ2k2VAyugfFulyqp) to help model this.

The energy use of the cluster E based on the GPU utilization G and the CPU utilization C is:
```
E(G,C) = ((idle cluster power) + (net CPU TDP) x (number of CPUs) + (net GPU TDP) x (number of GPUs))
```

Note that this must be multiplied by the datacenter PUE or WUE!


#### Energy per GPU-hour
The energy use for one GPU hour assuming 100% GPU and no incremental CPU would be:
```
E(gpu-hour) = E(100,0) / 1000 / (number of GPUs)
            = ((idle cluster power) / (number of GPUs) + (net GPU TDP)) / 1000
```

### Embodied emissions

- The embodied emissions of the server (see [Towards Green AI](https://arxiv.org/pdf/2407.10237) for an example PCF)
- The embodied emissions of the GPU
- The projected use life of the server (up to 6 years for cloud platforms, but suggest using 4 years for AI instances given pace of change)
- The projected utilization of the servers, noting that utilization means "time reserved" not "time active"

```
EmbEm(h) = ((number of GPUs) x (GPU embodied emissions) +
                               (number of servers) x (server embodied emissions))
                              / (use life in hours)
                              / (utilization)
```

### Embodied water use

The embodied water use of the CPU, GPU, and memory chips can be derived from manufacturer sustainability reporting or industry averages, generally based on die size. See [NVIDIA A100](/nvidia_a100#water_use) as an example.

Using:
- The manufacturing water use of the CPU
- The manufacturing water use of the GPU
- The manufacturing water use of the memory chips

The embodied water use is:
```
EmbH20(h) = ((number of GPUs) x (water use per GPU) +
             (number of CPUs) x (water use per CPU) +
             (number of memory chips) x (water use per memory chip))
            / (use life in hours)
            / (utilization)
```
